extends layout

block content
    
    .w3-light-grey
        header.w3-container.w3-theme-d4.w3-text-white
            h1.w3-opacity Gestor de Recursos
                button.w3-margin-bottom.w3-right.w3-button.w3-round-large.w3-text-white.w3-large
                    a(href='/').w3-right Logout
        
        .w3-bar.w3-theme-d4
            h4
                button.w3-bar-item.w3-hover-blue-grey.w3-padding(class="w3-theme-d3 tablink", onclick="openDiv(event, 'recursos');") Lista de Recursos
                if produtores
                    button.w3-bar-item.w3-hover-blue-grey.w3-padding(class="w3-theme-d4 tablink", onclick="openDiv(event, 'users');") Lista de Utilizadores
                if pessoais
                    button.w3-bar-item.w3-hover-blue-grey.w3-padding(class="w3-theme-d4 tablink", onclick="openDiv(event, 'pessoais');") Os Meus Recursos
                    div(class="botao", id="botao_pessoais" style="display:none")
                        a(href='/files/upload').w3-right
                            button.w3-right.w3-button.w3-round-xxlarge.w3-text-white.w3-large.w3-margin-right.w3-theme-d3
                                span + Novo Recurso

        div.w3-container.w3-display-container(class="lista", id="recursos", style="display:block")
            table.w3-table-all
                tr.w3-theme-d3
                    th(style="width:600px;") Título
                    th(style="width:300px;") Autor
                    th.w3-center Tipo
                    th.w3-center Data Registo
                    if produtores
                        th.w3-center Visibilidade
                        th.w3-center 
                    
                each r in recursos
                    tr
                        td 
                            a(href=`/recurso/${r.id}`) #{r.titulo}  
                        td #{r.autor}
                        td.w3-center #{r.tipo}
                        td.w3-center #{r.dataRegisto}

                        if produtores
                            if r.visibilidade == 1
                                td.w3-center Privado
                            else
                                td.w3-center Público
                        
                            td.w3-center
                                a(href=`/recurso/${r.id}/remover`) Eliminar

        if produtores
            div(class="lista", id="users", style="display:none")
                .w3-bar.w3-theme-d3.w3-margin-bottom.w3-padding
                    span
                        button.w3-bar-item.w3-padding(class="w3-theme-d2 2tab", onclick="openUsers(event, 'consumidores');") Lista de Consumidores
                        button.w3-bar-item.w3-hover-blue-grey.w3-padding(class="w3-theme-d3 2tab", onclick="openUsers(event, 'produtores');") Lista de Produtores

                div.w3-container.w3-display-container(class="users", id="consumidores", style="display:block")

                    if consumidores.length
                        table.w3-table-all
                            tr.w3-theme-d3
                                th(style="width:500px;") Username
                                th Email
                                th.w3-center(style="width:500px;") Afiliação
                                th
                                th
                            each c in consumidores
                                tr
                                    td #{c.username} 
                                    td= c.email 
                                    td.w3-center= c.filiacao
                                    td
                                        a(href=`/user/${c.username}/upgrade`) Upgrade
                                    td
                                        a(href=`/user/${c.username}/remover`) Eliminar
                    else
                        span Não existem consumidores.

                div.w3-container.w3-display-container(class="users", id="produtores", style="display:none")

                    if produtores.length

                        table.w3-table-all
                            tr.w3-theme-d3
                                th(style="width:500px;") Username
                                th Email
                                th.w3-center(style="width:500px;") Afiliação
                                th
                                th
                            each pr in produtores
                                tr
                                    td #{pr.username}
                                    td #{pr.email}
                                    td.w3-center #{pr.filiacao}  
                                    td
                                        a(href=`/user/${pr.username}/downgrade`) Downgrade
                                    td
                                        a(href=`/user/${pr.username}/remover`) Eliminar

                    else
                        p Não existem produtores.

        if pessoais
            div.w3-container.w3-display-container(class="lista pessoais", id="pessoais", style="display:none")
                if pessoais.length
                    
                    table.w3-table-all
                        tr.w3-theme-d3
                            th(style="width:600px;") Título
                            th.w3-center(style="width:200px;") Tipo
                            th.w3-center(style="width:200px;") Visibilidade
                            th.w3-center(style="width:300px;") Data Registo
                            th
                            th
                        each p in pessoais
                            tr
                                td 
                                    a(href=`/recurso/${p.id}`) #{p.titulo}
                                td.w3-center #{p.tipo}
                                
                                if p.visibilidade == 1
                                    td.w3-center Privado
                                else
                                    td.w3-center Público

                                td.w3-center #{p.dataRegisto} 
                               
                                td
                                    a(href=`/recurso/${p.id}/editar`) Editar
                                td
                                    a(href=`/recurso/${p.id}/remover`) Remover
                else
                    p Não tem recursos.

        .w3-container.w3-theme-d4.w3-text-white.w3-padding.w3-margin-top.w3-padding-large
            span PRI2020