extends layout

block content

    .w3-light-grey
        header.w3-container.w3-theme-d4.w3-text-white
            a(href="/mainPage" style="text-decoration: none")
                h1.w3-opacity Gestor de Recursos
                    
        .w3-bar.w3-theme-d4
            if vis == 4
                h3.w3-margin-left Utilizador 
                    a(href=`/user/${user.username}` style="text-decoration: none") #{user.username}       
            else if vis == 1
                h3.w3-margin-left Utilizador 
                    a(href=`/user/${user.username}` style="text-decoration: none") #{user.username}       
            else
                h3.w3-margin-left O Meu Perfil
                    a(href=`/user/${user.username}` style="text-decoration: none") 
                        span.w3-margin-left.w3-opacity  #{user.username}       

        .w3-bar.w3-theme-d4
            span
                if tab === "tab1"
                    button.w3-bar-item.w3-hover-opacity.w3-padding(class="w3-theme-d3 tablink", onclick="openDiv(event, 'perfil', 'nao');") Perfil
                    button.w3-bar-item.w3-hover-opacity.w3-padding(class="w3-theme-d4 tablink", onclick="openDiv(event, 'recursos', 'nao');") Recursos
                else
                    button.w3-bar-item.w3-hover-opacity.w3-padding(class="w3-theme-d4 tablink", onclick="openDiv(event, 'perfil', 'nao');") Perfil
                    button.w3-bar-item.w3-hover-opacity.w3-padding(class="w3-theme-d3 tablink", onclick="openDiv(event, 'recursos', 'nao');") Recursos
                if user.username === username
                    button.w3-right.w3-button.w3-round-large.w3-text-white.w3-medium.w3-hover-red(onclick="addConfirmacao()") Eliminar Conta     
                else
                    if nivel == "admin"
                        button.w3-right.w3-button.w3-round-large.w3-text-white.w3-medium.w3-hover-red(onclick="addConfirmacao()") Eliminar Utilizador

        - var tab1 = "block"   
        - var tab2 = "none"   
        if tab === "tab2"
            - var tab1 = "none"
            - var tab2 = "block"

        div.w3-container.w3-display-container(class="lista", id="perfil", style=`display:${tab1}`)
            h5
                b.w3-text-blue-grey Nível:
                span  #{user.level}

            if vis < 4
                h5
                    b.w3-text-blue-grey Email:
                    span  #{user.email}

            h5
                b.w3-text-blue-grey Filiação:
                span  #{user.filiacao}

            h5
                b.w3-text-blue-grey Data Registo:
                span  #{user.dataRegisto}

            h5
                b.w3-text-blue-grey Último Acesso:
                span  #{user.dataLastAcess}


            h5.w3-text-blue-grey
                b Comentários:
                if vis < 4
                    button.w3-right.w3-button.w3-round-large.w3-text-blue-grey.w3-medium(onclick="document.getElementById('removerComentarios').style.display='block'") 
                        b - Remover Comentários

            table.w3-table.w3-border.w3-bordered
                if comentarios.length
                    tr.w3-theme-d3.w3-mobile
                        td Recurso
                        td Texto
                        td.w3-right.w3-margin-right

                    each c in comentarios
                        tr
                            td
                                a(href=`/recurso/${c.recursoID}`) #{c.recursoID}
                            td
                                span  #{c.text}
                            
                            if vis < 4
                                td.w3-right.w3-margin-right.w3-hover-text-red
                                    a(href=`/comentario/remover/${c._id}?user=${user.username}`) Eliminar

                            td.w3-right.w3-margin-right #{c.data}
                            
                            
                else
                    span Não existem comentários

            br     
        
        div.w3-display-container(class="lista", id="recursos", style=`display:${tab2}`)
            if recursos.length
                .w3-bar.w3-theme-d3.w3-padding-small
                    h6.w3-margin-left Género: 
                        each t in tipos
                            input.w3-check.w3-opacity.w3-margin-left(style="height:20px" type="checkbox" value="checked" class="check" onclick=`showGeneros(event, '${t}')` checked)
                            label  #{t}
                        button.w3-opacity.w3-round.w3-button.w3-right.w3-padding-small.w3-margin-right(id="limpar" onclick="limparGeneros(event)") Limpar
                    h6
                        span.w3-dropdown-hover.w3-margin-left.w3-margin-bottom.w3-theme-d3 Ordenar por:
                            span.w3-text-white.w3-round.w3-border-0.w3-hover-opacity.w3-theme-d3.w3-margin-left= sort
                            span.w3-dropdown-content.w3-bar-block
                                if sort != "id"
                                    a(href=`/user/${user.username}?tab=recs&sortBy=id`).w3-bar-item.w3-button.w3-theme-d3.w3-hover-opacity ID
                                if sort != "titulo"
                                    a(href=`/user/${user.username}?tab=recs&sortBy=titulo`).w3-bar-item.w3-button.w3-theme-d3.w3-hover-opacity Título
                                if sort != "dataRegisto"
                                    a(href=`/user/${user.username}?tab=recs&sortBy=dataRegisto`).w3-bar-item.w3-button.w3-theme-d3.w3-hover-opacity Data Registo
           
            include ./listaRecursos.pug



        //- de certeza que queres eliminar?
        div.w3-modal(id="confirmar" style="display:none")
            div.w3-modal-content.w3-theme-d3.w3-round-large(style="width:450px")
                div.w3-container.w3-padding-16
                    if user.username === username
                        h5.w3-center.w3-margin-bottom Tem a certeza que quer eliminar a sua conta?
                    else
                        h5.w3-center.w3-margin-bottom Tem a certeza que quer eliminar este utilizador?
                    h5.w3-center
                        a(href=`/user/${user.username}/remover?tab=3}`)
                            button.w3-button.w3-round.w3-white.w3-text-blue-grey.w3-medium
                                i(class="fa fa-check")
                        button.w3-button.w3-round.w3-white.w3-text-blue-grey.w3-medium.w3-margin-left(onclick="document.getElementById('confirmar').style.display='none'")
                            i(class="fa fa-close")

        //- de certeza que queres eliminar os comentarios?
        div.w3-modal(id="removerComentarios" style="display:none")
            div.w3-modal-content.w3-theme-d3.w3-round-large(style="width:450px")
                div.w3-container.w3-padding-16
                    h5.w3-center.w3-margin-bottom Tem a certeza que quer eliminar todos os comentários deste utilizador?
                    h5.w3-center
                        a(href=`/user/${user.username}/remover/comentarios`)
                            button.w3-button.w3-round.w3-white.w3-text-blue-grey.w3-medium
                                i(class="fa fa-check")
                        button.w3-button.w3-round.w3-white.w3-text-blue-grey.w3-medium.w3-margin-left(onclick="document.getElementById('removerComentarios').style.display='none'")
                            i(class="fa fa-close")


        .w3-container.w3-theme-d4.w3-text-white.w3-padding.w3-padding-large
            address 
                span(onclick="window.history.go(-1)" style="text-decoration: underline; cursor:pointer;" ) Voltar